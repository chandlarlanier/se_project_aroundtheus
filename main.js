!function(){"use strict";class e{constructor(e,t){let{data:s,handleImageClick:n}=e;this._name=s.name,this._link=s.link,this._cardSelector=t,this._handleImageClick=n}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}_handleDeleteCard(){this._cardElement.remove(),this._cardElement=null}_handleLikeIcon(){this._cardElement.querySelector(".card__like-button").classList.toggle("card__like-button_active")}_setEventListeners(){this._likeButton.addEventListener("mousedown",(()=>this._handleLikeIcon())),this._deleteButton.addEventListener("mousedown",(()=>this._handleDeleteCard())),this._cardImage.addEventListener("mousedown",(()=>{this._handleImageClick({link:this._link,name:this._name})}))}generateCard(){return this._cardElement=this._getTemplate(),this._likeButton=this._cardElement.querySelector(".card__like-button"),this._deleteButton=this._cardElement.querySelector(".card__delete-button"),this._cardImage=this._cardElement.querySelector(".card__image"),this._cardDescription=this._cardElement.querySelector(".card__description"),this._setEventListeners(),this._cardImage.src=this._link,this._cardImage.alt=`Photo of ${this._name}`,this._cardDescription.textContent=this._name,this._cardElement}}class t{constructor(e){this._popupElement=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popupElement.classList.add("popup_opened"),document.addEventListener("keyup",this._handleEscClose)}close(){this._popupElement.classList.remove("popup_opened"),document.removeEventListener("keyup",this._handleEscClose)}_handleEscClose(e){"Escape"==e.key&&this.close()}setEventListeners(){this._popupElement.querySelector(".popup__close-button").addEventListener("mousedown",(()=>{this.close()})),this._popupElement.addEventListener("mousedown",(e=>{e.target.classList.contains("popup")&&this.close()}))}}class s extends t{constructor(e,t){super(e),this._popupForm=this._popupElement.querySelector(".popup__form"),this._submitButton=this._popupElement.querySelector(".popup__button"),this._handleFormSubmit=t}close(){super.close(),this._popupForm.reset()}_getInputValues(){const e=[...this._popupForm.querySelectorAll(".popup__input")],t={};for(const s of e)t[s.name]=s.value;return t}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues()),this.close()}))}}document.querySelector(".profile__title"),document.querySelector(".profile__description");const n=document.querySelector(".popup__input_type_name"),o=document.querySelector(".popup__input_type_description"),i={inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},r=document.forms["popup__form_type_edit-profile"],a=document.forms["popup__form_type_add-card"];class l{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t,this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._buttonElement=this._formElement.querySelector(this._submitButtonSelector)}_showInputError(e,t){const s=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),s.textContent=t,s.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass),t.textContent=""}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}disableButton(){this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disabled=!0}_enableButton(){this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1}toggleButtonState(){this._hasInvalidInput()?this.disableButton():this._enableButton()}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_setEventListeners(){this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}const u=t=>{const s=new e({data:t,handleImageClick:e=>{p.open(e)}},".card-template");c.addItem(s.generateCard())},p=new class extends t{constructor(e){super(e),this._imageElement=this._popupElement.querySelector(".popup__image"),this._imageCaption=this._popupElement.querySelector(".popup__heading_type_preview-image")}open(e){this._imageCaption.textContent=e.name,this._imageElement.src=e.link,this._imageElement.alt=`Photo of ${e.name}`,super.open()}}(".popup_type_preview-image"),c=new class{constructor(e,t){let{renderer:s}=e;this._renderer=s,this._element=document.querySelector(t)}renderItems(e){e.forEach(this._renderer)}addItem(e){this._element.prepend(e)}}({renderer:u},".cards__list"),_=new class{constructor(e){let{nameSelector:t,aboutMeSelector:s}=e;this._nameElement=document.querySelector(t),this._aboutMeElement=document.querySelector(s)}getUserInfo(){return{name:this._nameElement.textContent,about:this._aboutMeElement.textContent}}setUserInfo(e){let{name:t,description:s}=e;this._nameElement.textContent=t,this._aboutMeElement.textContent=s}}({nameSelector:".profile__title",aboutMeSelector:".profile__description"}),d=new s(".popup_type_edit-profile",(e=>{_.setUserInfo(e)})),m=new s(".popup_type_add-card",(e=>{u(e)})),h=new l(i,r),E=new l(i,a);c.renderItems([{name:"Yosemite Valley",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/yosemite.jpg"},{name:"Grand Canyon",link:"https://images.unsplash.com/photo-1615551043360-33de8b5f410c?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1476&q=80"},{name:"Space Needle",link:"https://images.unsplash.com/photo-1594664233467-708a77a3299f?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8OXx8c3BhY2UlMjBuZWVkbGV8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=800&q=60"},{name:"Bald Mountains",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/bald-mountains.jpg"},{name:"Arches National Park",link:"https://images.unsplash.com/photo-1615046727544-8fd9ac9836cf?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1470&q=80"},{name:"Golden Gate Bridge",link:"https://images.unsplash.com/photo-1613048998814-4af1bd82fb01?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTR8fGdvbGRlbiUyMGdhdGUlMjBicmlkZ2V8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=800&q=60"}]),p.setEventListeners(),d.setEventListeners(),m.setEventListeners(),h.enableValidation(),E.enableValidation(),document.querySelector(".profile__edit-button").addEventListener("mousedown",(()=>{const e=_.getUserInfo();n.value=e.name,o.value=e.about,h.disableButton(),d.open()})),document.querySelector(".profile__add-button").addEventListener("mousedown",(()=>{E.disableButton(),m.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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V3BHLEVBQUssSUFLWitILEVBQW9CLElBQUkxRCxFQUFjVCxFQUFvQk0sR0FDMUQ4RCxFQUFvQixJQUFJM0QsRUFBY1QsRUFBb0JRLEdBSWhFb0MsRUFBWVEsWUY5Q2dCLENBQzFCLENBQ0U1RyxLQUFNLGtCQUNORSxLQUFNLHNHQUVSLENBQ0VGLEtBQU0sZUFDTkUsS0FBTSwwS0FFUixDQUNFRixLQUFNLGVBQ05FLEtBQU0sdUxBRVIsQ0FDRUYsS0FBTSxpQkFDTkUsS0FBTSw0R0FFUixDQUNFRixLQUFNLHVCQUNORSxLQUFNLDBLQUVSLENBQ0VGLEtBQU0scUJBQ05FLEtBQU0scU1Fd0JWaUcsRUFBaUI5RCxvQkFDakJvRixFQUFpQnBGLG9CQUNqQnFGLEVBQWFyRixvQkFDYnNGLEVBQWtCNUIsbUJBQ2xCNkIsRUFBa0I3QixtQkFJUXpGLFNBQVNDLGNBQWMseUJBQy9CVyxpQkFBaUIsYUFBYSxLQUM5QyxNQUFNMkcsRUFBT2QsRUFBU0ssY0FDdEI5RCxFQUFVRixNQUFReUUsRUFBSzdILEtBQ3ZCdUQsRUFBV0gsTUFBUXlFLEVBQUtSLE1BQ3hCTSxFQUFrQm5DLGdCQUNsQmlDLEVBQWlCMUYsTUFBTSxJQUdIekIsU0FBU0MsY0FBYyx3QkFDL0JXLGlCQUFpQixhQUFhLEtBQzFDMEcsRUFBa0JwQyxnQkFDbEJrQyxFQUFhM0YsTUFBTSxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3IoeyBkYXRhLCBoYW5kbGVJbWFnZUNsaWNrIH0sIGNhcmRTZWxlY3Rvcikge1xuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcblxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcbiAgfVxuXG4gIF9nZXRUZW1wbGF0ZSgpIHtcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG5cbiAgICByZXR1cm4gY2FyZEVsZW1lbnQ7XG4gIH1cblxuICBfaGFuZGxlRGVsZXRlQ2FyZCgpIHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7XG4gIH1cblxuICBfaGFuZGxlTGlrZUljb24oKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKS5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoKSA9PiB0aGlzLl9oYW5kbGVMaWtlSWNvbigpKTtcbiAgICB0aGlzLl9kZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoKSA9PiB0aGlzLl9oYW5kbGVEZWxldGVDYXJkKCkpO1xuICAgIHRoaXMuX2NhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2soeyBsaW5rOiB0aGlzLl9saW5rLCBuYW1lOiB0aGlzLl9uYW1lIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgZ2VuZXJhdGVDYXJkKCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcbiAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcbiAgICB0aGlzLl9kZWxldGVCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIik7XG4gICAgdGhpcy5fY2FyZEltYWdlID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcbiAgICB0aGlzLl9jYXJkRGVzY3JpcHRpb24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2Rlc2NyaXB0aW9uXCIpO1xuXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgIHRoaXMuX2NhcmRJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xuICAgIHRoaXMuX2NhcmRJbWFnZS5hbHQgPSBgUGhvdG8gb2YgJHt0aGlzLl9uYW1lfWA7XG4gICAgdGhpcy5fY2FyZERlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcblxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7XG4gIH1cblxuICBvcGVuKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwicG9wdXBfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgX2hhbmRsZUVzY0Nsb3NlKGV2dCkge1xuICAgIGlmIChldnQua2V5ID09IFwiRXNjYXBlXCIpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19jbG9zZS1idXR0b25cIilcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfSk7XG5cbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoZXZ0KSA9PiB7XG4gICAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cFwiKSkge1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1cIik7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2J1dHRvblwiKTtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHN1cGVyLmNsb3NlKCk7XG4gICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XG4gIH1cblxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgY29uc3QgaW5wdXRMaXN0ID0gWy4uLnRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLnBvcHVwX19pbnB1dFwiKV07XG4gICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fTtcbiAgICBmb3IgKGNvbnN0IGlucHV0IG9mIGlucHV0TGlzdCkge1xuICAgICAgaW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGlucHV0VmFsdWVzO1xuICB9XG5cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9KTtcbiAgfVxufVxuIiwiZXhwb3J0IGNvbnN0IEVTQ19LRVlDT0RFID0gMjc7XG5cbmV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXG4gIHtcbiAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC95b3NlbWl0ZS5qcGdcIlxuICB9LFxuICB7XG4gICAgbmFtZTogXCJHcmFuZCBDYW55b25cIixcbiAgICBsaW5rOiBcImh0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNjE1NTUxMDQzMzYwLTMzZGU4YjVmNDEwYz9peGxpYj1yYi00LjAuMyZpeGlkPU0zd3hNakEzZkRCOE1IeHdhRzkwYnkxd1lXZGxmSHg4ZkdWdWZEQjhmSHg4ZkElM0QlM0QmYXV0bz1mb3JtYXQmZml0PWNyb3Amdz0xNDc2JnE9ODBcIlxuICB9LFxuICB7XG4gICAgbmFtZTogXCJTcGFjZSBOZWVkbGVcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNTk0NjY0MjMzNDY3LTcwOGE3N2EzMjk5Zj9peGxpYj1yYi00LjAuMyZpeGlkPU0zd3hNakEzZkRCOE1IeHpaV0Z5WTJoOE9YeDhjM0JoWTJVbE1qQnVaV1ZrYkdWOFpXNThNSHg4TUh4OGZEQSUzRCZhdXRvPWZvcm1hdCZmaXQ9Y3JvcCZ3PTgwMCZxPTYwXCJcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnXCJcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiQXJjaGVzIE5hdGlvbmFsIFBhcmtcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNjE1MDQ2NzI3NTQ0LThmZDlhYzk4MzZjZj9peGxpYj1yYi00LjAuMyZpeGlkPU0zd3hNakEzZkRCOE1IeHdhRzkwYnkxd1lXZGxmSHg4ZkdWdWZEQjhmSHg4ZkElM0QlM0QmYXV0bz1mb3JtYXQmZml0PWNyb3Amdz0xNDcwJnE9ODBcIlxuICB9LFxuICB7XG4gICAgbmFtZTogXCJHb2xkZW4gR2F0ZSBCcmlkZ2VcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNjEzMDQ4OTk4ODE0LTRhZjFiZDgyZmIwMT9peGxpYj1yYi00LjAuMyZpeGlkPU0zd3hNakEzZkRCOE1IeHpaV0Z5WTJoOE1UUjhmR2R2YkdSbGJpVXlNR2RoZEdVbE1qQmljbWxrWjJWOFpXNThNSHg4TUh4OGZEQSUzRCZhdXRvPWZvcm1hdCZmaXQ9Y3JvcCZ3PTgwMCZxPTYwXCJcbiAgfVxuXTtcblxuZXhwb3J0IGNvbnN0IHVzZXJOYW1lRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fdGl0bGVcIik7XG5leHBvcnQgY29uc3QgdXNlckpvYkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIpO1xuZXhwb3J0IGNvbnN0IG5hbWVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2lucHV0X3R5cGVfbmFtZVwiKTtcbmV4cG9ydCBjb25zdCBhYm91dElucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW5wdXRfdHlwZV9kZXNjcmlwdGlvblwiKTtcblxuLy8gU2VsZWN0b3JzXG5leHBvcnQgY29uc3Qgc2VsZWN0b3JzID0ge1xuICBjYXJkTGlzdDogXCIuY2FyZHNfX2xpc3RcIixcbiAgY2FyZFRlbXBsYXRlOiBcIi5jYXJkLXRlbXBsYXRlXCIsXG4gIHByZXZpZXdQb3B1cDogXCIucG9wdXBfdHlwZV9wcmV2aWV3LWltYWdlXCIsXG4gIGVkaXRQcm9maWxlUG9wdXA6IFwiLnBvcHVwX3R5cGVfZWRpdC1wcm9maWxlXCIsXG4gIGFkZENhcmRQb3B1cDogXCIucG9wdXBfdHlwZV9hZGQtY2FyZFwiLFxuICBuYW1lRWxlbWVudDogXCIucHJvZmlsZV9fdGl0bGVcIixcbiAgZGVzY3JpcHRpb25FbGVtZW50OiBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiXG59XG5cbi8vIFZhbGlkYXRpb24gU2V0dGluZ3NcbmV4cG9ydCBjb25zdCB2YWxpZGF0aW9uU2V0dGluZ3MgPSB7XG4gIGlucHV0U2VsZWN0b3I6IFwiLnBvcHVwX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIucG9wdXBfX2J1dHRvblwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwX19idXR0b25fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcInBvcHVwX19pbnB1dF90eXBlX2Vycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwicG9wdXBfX2Vycm9yX3Zpc2libGVcIixcbn07XG5cbi8vIEZvcm1zXG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRGb3JtID0gZG9jdW1lbnQuZm9ybXNbXCJwb3B1cF9fZm9ybV90eXBlX2VkaXQtcHJvZmlsZVwiXTtcbmV4cG9ydCBjb25zdCBhZGRDYXJkRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wicG9wdXBfX2Zvcm1fdHlwZV9hZGQtY2FyZFwiXTtcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3Rvcihjb25maWcsIGZvcm1FbGVtZW50KSB7XG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IGNvbmZpZy5pbnB1dFNlbGVjdG9yO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcztcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBjb25maWcuaW5wdXRFcnJvckNsYXNzO1xuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBjb25maWcuZXJyb3JDbGFzcztcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xuICAgIHRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20odGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKSk7XG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuICB9XG5cbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlKSB7XG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvclxuICAgICAgKGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XG5cbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yXG4gICAgICAoYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcblxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcbiAgfVxuXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9XG4gIH1cblxuICBkaXNhYmxlQnV0dG9uKCkge1xuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcbiAgfVxuXG4gIF9lbmFibGVCdXR0b24oKSB7XG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcbiAgfVxuXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKCkge1xuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQoKSkge1xuICAgICAgdGhpcy5kaXNhYmxlQnV0dG9uKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2VuYWJsZUJ1dHRvbigpO1xuICAgIH1cbiAgfVxuXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIHJldHVybiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkO1xuICAgIH0pO1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcbiAgICAgICAgdGhpcy50b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH07XG5cbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfTtcbn07XG4iLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IHtpbml0aWFsQ2FyZHMsIHNlbGVjdG9ycywgdmFsaWRhdGlvblNldHRpbmdzLCBwcm9maWxlRWRpdEZvcm0sIGFkZENhcmRGb3JtLCBuYW1lSW5wdXQsIGFib3V0SW5wdXR9IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcblxuLy8gQ2FyZCByZW5kZXJlciBmdW5jdGlvblxuY29uc3QgcmVuZGVyQ2FyZCA9IChkYXRhKSA9PiB7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gbmV3IENhcmQoXG4gICAge1xuICAgICAgZGF0YSxcbiAgICAgIGhhbmRsZUltYWdlQ2xpY2s6IChpbWdEYXRhKSA9PiB7XG4gICAgICAgIGNhcmRQcmV2aWV3UG9wdXAub3BlbihpbWdEYXRhKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIHNlbGVjdG9ycy5jYXJkVGVtcGxhdGVcbiAgKTtcbiAgY2FyZFNlY3Rpb24uYWRkSXRlbShjYXJkRWxlbWVudC5nZW5lcmF0ZUNhcmQoKSk7XG59XG5cblxuLy8gQ3JlYXRlIGNhcmQgYW5kIGNhcmQgaW1hZ2UgcG9wdXAgaW5zdGFuY2VzXG5leHBvcnQgY29uc3QgY2FyZFByZXZpZXdQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShzZWxlY3RvcnMucHJldmlld1BvcHVwKTtcbmV4cG9ydCBjb25zdCBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKHsgcmVuZGVyZXI6IHJlbmRlckNhcmQgfSwgc2VsZWN0b3JzLmNhcmRMaXN0KTtcblxuXG4vLyBDcmVhdGUgZm9ybSBhbmQgdXNlciBpbmZvIGluc3RhbmNlc1xuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe25hbWVTZWxlY3Rvcjogc2VsZWN0b3JzLm5hbWVFbGVtZW50LCBhYm91dE1lU2VsZWN0b3I6IHNlbGVjdG9ycy5kZXNjcmlwdGlvbkVsZW1lbnR9KTtcblxuY29uc3QgZWRpdFByb2ZpbGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKHNlbGVjdG9ycy5lZGl0UHJvZmlsZVBvcHVwLCAoZGF0YSkgPT4ge1xuICB1c2VySW5mby5zZXRVc2VySW5mbyhkYXRhKTtcbn0pO1xuXG5jb25zdCBhZGRDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShzZWxlY3RvcnMuYWRkQ2FyZFBvcHVwLCAoZGF0YSkgPT4ge1xuICByZW5kZXJDYXJkKGRhdGEpO1xufSk7XG5cblxuLy8gRm9ybSB2YWxpZGF0aW9uXG5jb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25TZXR0aW5ncywgcHJvZmlsZUVkaXRGb3JtKTtcbmNvbnN0IGNhcmRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvblNldHRpbmdzLCBhZGRDYXJkRm9ybSk7XG5cblxuLy8gSW5pdGlhbGl6ZSBhbGwgY2xhc3MgaW5zdGFuY2VzXG5jYXJkU2VjdGlvbi5yZW5kZXJJdGVtcyhpbml0aWFsQ2FyZHMpO1xuY2FyZFByZXZpZXdQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuZWRpdFByb2ZpbGVQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuYWRkQ2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5lZGl0Rm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5jYXJkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cblxuLy8gQWRkIGV2ZW50IGxpc3RlbmVycyB0byBidXR0b25zXG5jb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idXR0b25cIik7XG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsICgpID0+IHtcbiAgY29uc3QgaW5mbyA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XG4gIG5hbWVJbnB1dC52YWx1ZSA9IGluZm8ubmFtZTtcbiAgYWJvdXRJbnB1dC52YWx1ZSA9IGluZm8uYWJvdXQ7XG4gIGVkaXRGb3JtVmFsaWRhdG9yLmRpc2FibGVCdXR0b24oKTtcbiAgZWRpdFByb2ZpbGVQb3B1cC5vcGVuKCk7XG59KTtcblxuY29uc3QgYWRkQ2FyZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcbmFkZENhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoKSA9PiB7XG4gIGNhcmRGb3JtVmFsaWRhdG9yLmRpc2FibGVCdXR0b24oKTtcbiAgYWRkQ2FyZFBvcHVwLm9wZW4oKTtcbn0pO1xuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5faW1hZ2VFbGVtZW50ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2ltYWdlXCIpO1xuICAgIHRoaXMuX2ltYWdlQ2FwdGlvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIucG9wdXBfX2hlYWRpbmdfdHlwZV9wcmV2aWV3LWltYWdlXCJcbiAgICApO1xuICB9XG5cbiAgb3BlbihkYXRhKSB7XG4gICAgdGhpcy5faW1hZ2VDYXB0aW9uLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xuICAgIHRoaXMuX2ltYWdlRWxlbWVudC5zcmMgPSBkYXRhLmxpbms7XG4gICAgdGhpcy5faW1hZ2VFbGVtZW50LmFsdCA9IGBQaG90byBvZiAke2RhdGEubmFtZX1gO1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHtyZW5kZXJlcn0sIHNlbGVjdG9yKSB7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9lbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XG4gIH1cblxuICByZW5kZXJJdGVtcyhkYXRhKSB7XG4gICAgZGF0YS5mb3JFYWNoKHRoaXMuX3JlbmRlcmVyKTtcbiAgfVxuXG4gIGFkZEl0ZW0oaXRlbSkge1xuICAgIHRoaXMuX2VsZW1lbnQucHJlcGVuZChpdGVtKTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgdXNlck5hbWVFbGVtZW50LCB1c2VySm9iRWxlbWVudCwgbmFtZUlucHV0LCBqb2JJbnB1dCB9IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3Rvcih7IG5hbWVTZWxlY3RvciAsIGFib3V0TWVTZWxlY3RvciB9KSB7XG4gICAgdGhpcy5fbmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XG4gICAgdGhpcy5fYWJvdXRNZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGFib3V0TWVTZWxlY3Rvcik7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICBjb25zdCB1c2VySW5mbyA9IHtuYW1lOiB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCwgYWJvdXQ6IHRoaXMuX2Fib3V0TWVFbGVtZW50LnRleHRDb250ZW50fTtcbiAgICByZXR1cm4gdXNlckluZm87XG4gIH1cblxuICBzZXRVc2VySW5mbyh7bmFtZSwgZGVzY3JpcHRpb259KSB7XG4gICAgdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHRoaXMuX2Fib3V0TWVFbGVtZW50LnRleHRDb250ZW50ID0gZGVzY3JpcHRpb247XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJDYXJkIiwiY29uc3RydWN0b3IiLCJfcmVmIiwiY2FyZFNlbGVjdG9yIiwiZGF0YSIsImhhbmRsZUltYWdlQ2xpY2siLCJ0aGlzIiwiX25hbWUiLCJuYW1lIiwiX2xpbmsiLCJsaW5rIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2dldFRlbXBsYXRlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsIl9oYW5kbGVEZWxldGVDYXJkIiwiX2NhcmRFbGVtZW50IiwicmVtb3ZlIiwiX2hhbmRsZUxpa2VJY29uIiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2xpa2VCdXR0b24iLCJhZGRFdmVudExpc3RlbmVyIiwiX2RlbGV0ZUJ1dHRvbiIsIl9jYXJkSW1hZ2UiLCJnZW5lcmF0ZUNhcmQiLCJfY2FyZERlc2NyaXB0aW9uIiwic3JjIiwiYWx0IiwidGV4dENvbnRlbnQiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBFbGVtZW50IiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsIm9wZW4iLCJhZGQiLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJldnQiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImNvbnRhaW5zIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9wb3B1cEZvcm0iLCJfc3VibWl0QnV0dG9uIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJyZXNldCIsIl9nZXRJbnB1dFZhbHVlcyIsImlucHV0TGlzdCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbnB1dFZhbHVlcyIsImlucHV0IiwidmFsdWUiLCJwcmV2ZW50RGVmYXVsdCIsIm5hbWVJbnB1dCIsImFib3V0SW5wdXQiLCJ2YWxpZGF0aW9uU2V0dGluZ3MiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsInByb2ZpbGVFZGl0Rm9ybSIsImZvcm1zIiwiYWRkQ2FyZEZvcm0iLCJGb3JtVmFsaWRhdG9yIiwiY29uZmlnIiwiZm9ybUVsZW1lbnQiLCJfaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiX2Zvcm1FbGVtZW50IiwiX2lucHV0TGlzdCIsIkFycmF5IiwiZnJvbSIsIl9idXR0b25FbGVtZW50IiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JNZXNzYWdlIiwiZXJyb3JFbGVtZW50IiwiaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiZGlzYWJsZUJ1dHRvbiIsImRpc2FibGVkIiwiX2VuYWJsZUJ1dHRvbiIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiX2hhc0ludmFsaWRJbnB1dCIsInNvbWUiLCJmb3JFYWNoIiwiZW5hYmxlVmFsaWRhdGlvbiIsInJlbmRlckNhcmQiLCJjYXJkRWxlbWVudCIsImltZ0RhdGEiLCJjYXJkUHJldmlld1BvcHVwIiwiY2FyZFNlY3Rpb24iLCJhZGRJdGVtIiwiX2ltYWdlRWxlbWVudCIsIl9pbWFnZUNhcHRpb24iLCJzZWxlY3RvciIsInJlbmRlcmVyIiwiX3JlbmRlcmVyIiwiX2VsZW1lbnQiLCJyZW5kZXJJdGVtcyIsIml0ZW0iLCJwcmVwZW5kIiwidXNlckluZm8iLCJuYW1lU2VsZWN0b3IiLCJhYm91dE1lU2VsZWN0b3IiLCJfbmFtZUVsZW1lbnQiLCJfYWJvdXRNZUVsZW1lbnQiLCJnZXRVc2VySW5mbyIsImFib3V0Iiwic2V0VXNlckluZm8iLCJfcmVmMiIsImRlc2NyaXB0aW9uIiwiZWRpdFByb2ZpbGVQb3B1cCIsImFkZENhcmRQb3B1cCIsImVkaXRGb3JtVmFsaWRhdG9yIiwiY2FyZEZvcm1WYWxpZGF0b3IiLCJpbmZvIl0sInNvdXJjZVJvb3QiOiIifQ==